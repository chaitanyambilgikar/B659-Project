Make macarons batter: Line 2 large baking sheets with parchment paper.
Grind almond flour or almonds with confectioners sugar in food processor until powdery, 30 seconds for almond flour, about 2 minutes for almonds. (If using grinder, grind in small batches.) Sift through a medium-mesh sieve into a bowl (if not fine enough for almost all of nuts to go through sieve, regrind). Sift again into a large bowl.
Stir together espresso powder and vanilla in a cup until powder has dissolved.
Beat egg whites with salt in a bowl with an electric mixer at medium speed until they just hold soft peaks. Beat in granulated sugar, a little at a time. Increase speed to high and beat until meringue holds stiff, glossy peaks, about 1 minute. Add espresso mixture and mix at low speed until incorporated. Fold meringue into almond mixture with a rubber spatula until completely incorporated. (Meringue will deflate and batter will be loose.)
Pipe and bake macarons: Put small dabs of batter under corners of parchment to secure to baking sheets.
Spoon half of batter into pastry bag. Holding bag vertically just above baking sheet, pipe 1 1/2-inch-wide mounds of batter about 1 inch apart, stopping pressure and flicking tip sideways to avoid peaks (tamp down any peaks with a wet finger). Refill pastry bag and repeat. Let macarons stand, uncovered, at room temperature until a light crust forms, 20 to 30 minutes.
Meanwhile, preheat oven to 300°F with racks in upper and lower thirds.
Bake macarons, switching position of sheets halfway through, until crisp and interior does not give easily when gently pressed, 22 to 28 minutes total. Cool completely on baking sheets (to harden bottoms) on racks, about 30 minutes. Loosen macarons from parchment with offset spatula (they will be fragile).
Assemble cookies: Sandwich flat sides of macarons together with a thin layer of jelly.
Layer macarons between sheets of parchment in an airtight container and let stand at room temperature at least 2 hours to soften before eating.
Variations: Chocolate earl grey macarons: •Add 3 tablespoons Dutch-process cocoa powder (preferably Valrhona) to almond flour or almonds when grinding. •Omit instant-espresso powder and vanilla. •Grind 1 teaspoon Earl Grey tea (from 1 tea bag) to a fine powder in an electric coffee/spice grinder. Sprinkle about 1/4 teaspoon (reserve remainder) on macarons before baking. •Fill with chocolate Earl Grey ganache: Bring 1/2 cup cream and remaining 3/4 teaspoon tea powder to a simmer in a small heavy saucepan. Remove from heat and stir in 3 ounces finely chopped bittersweet chocolate (60% to 64% cacao if marked) and 1 tablespoon unsalted butter until smooth. Chill, whisking occasionally, until thickened, 20 to 30 minutes. Transfer to a sealable bag. Snip off a corner and pipe to fill macarons. (There will be ganache left over.)
Grapefruit macarons: •Add 2 teaspoons grated grapefruit zest to almond flour or almonds when grinding. •Omit instant-espresso powder and vanilla. •Beat 6 drops red food coloring into meringue. • Fill with grapefruit marmalade.
Coconut passion-fruit macarons: •Add 1 cup unsweetened grated dried coconut (3 ounces) to almond flour or almonds when grinding. •Omit instant-espresso powder and vanilla. •Beat 6 drops yellow food coloring into meringue. •Fill with passion-fruit curd: Whisk together 1/3 cup thawed passion-fruit purée, 1/3 cup sugar, 3 large egg yolks, and a pinch of salt in a small heavy saucepan. Add 1/2 stick butter (cut into pieces). Bring to a simmer over medium-low heat, whisking, then simmer, whisking constantly, until curd is thick, 1 to 2 minutes. Cool completely. Transfer to a sealable bag. Snip off a corner and pipe to fill macarons. (There will be curd left over.)
Pistachio-cardamom macarons: •Substitute 1/3 cup unsalted shelled pistachios plus 1/2 teaspoon ground cardamom for half of the almond flour or almonds when grinding. •Omit instant-espresso powder and vanilla. •Beat 4 drops green and 3 drops yellow food coloring into meringue. •Fill with apricot jam.
