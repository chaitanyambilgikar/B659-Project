For masala: Heat oil in large nonstick skillet over medium heat. Add onions; sauté until deep golden, about 20 minutes. Add garlic and all spices; stir 1 minute. Cool to lukewarm. Puree tomatoes with juices and yogurt in processor until almost smooth. Add onion mixture; puree until almost smooth. Season masala to taste with salt and pepper. (Masala can be made 1 day ahead. Cover and refrigerate.)
For shrimp: Heat oil in heavy large deep skillet over medium-high heat. Add shrimp and sauté until partially cooked, about 2 minutes. Stir in coconut milk, cilantro, green onions, lemon juice, and prepared masala. Simmer until shrimp are opaque in center, about 3 minutes longer. Season to taste with salt and pepper and serve.
