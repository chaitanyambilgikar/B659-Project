Cut off kernels from 1 ear corn. Cut remaining 2 ears corn (including cob) crosswise into 1-inch pieces.
Heat oil in a 4-quart heavy pot over moderate heat until hot but not smoking, then cook chiles, garlic, and onion, stirring occasionally, until onion is pale golden, about 7 minutes. Remove from heat and transfer chile mixture to a bowl with a slotted spoon, pressing mixture against side of pot to leave behind as much oil as possible. Do not clean pot; there will be a thin film of oil remaining.
Purée half of chile mixture with 1 cup broth and 2 1/4 teaspoons masa harina in a blender until smooth, then force purée through a medium-mesh sieve with a rubber spatula into a medium bowl.
Purée remaining chile mixture, 1 cup broth, and remaining 2 1/4 teaspoons masa harina in same manner, forcing through sieve into same bowl.
Heat oil remaining in pot over moderately high heat until hot but not smoking, then cook chile puré, stirring constantly, until it reaches a boil and is slightly thickened.
Stir in remaining 4 cups broth and bring to a simmer, stirring occasionally.
Stir in corn (kernels and pieces), mushrooms, green beans, potatoes, and epazote and gently simmer, uncovered, stirring occasionally, until beans are tender, 15 to 25 minutes.
Thin chileatole with a little more broth or water to attain a light cream soup consistency, then stir in salt.
