Finely chop onion. Mince garlic. Drain tomatoes and reserve juice. Coarsely chop tomatoes.
In a 12-inch skillet cook onion and garlic in oil over moderate heat until softened. Add tomatoes and reserved juice and cook over moderate heat, stirring occasionally, 40 minutes, or until thickened. Stir in vinegar, sugar, and salt and pepper to taste. Remove skillet from heat and cool sauce. Tomato sauce may be made 1 day ahead and chilled, covered.
In a 5-quart kettle bring 4 quarts salted water to a boil for shells. In boiling water cook pasta until al dente and drain in a colander.
Preheat oven to 350°F.
Drain tofu. Finely chop scallions. In a small bowl lightly beat egg.
In a food processor blend tofu, scallions, egg, parsley, ricotta, and 1/2 cup mozzarella until smooth. Spread about 1 cup tomato sauce in a baking dish. Fill each pasta shell with about 1 tablespoon cheese mixture and arrange shells in one layer, cheese sides up, over sauce. Pour remaining tomato sauce over shells and sprinkle with remaining 1/4 cup mozzarella. Bake shells in middle of oven 30 minutes, or until sauce is bubbling and cheese is melted.
