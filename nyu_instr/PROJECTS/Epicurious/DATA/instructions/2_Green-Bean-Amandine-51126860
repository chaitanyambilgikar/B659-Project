Preheat the oven to 375°F.
In a large sauté pan or wok over moderate heat, warm the oil. Add the shallots and sauté, stirring occasionally, for 2 minutes. Add the garlic and sauté, stirring occasionally, for 1 minute. Add the green beans, along with the vinegar, salt, and pepper, and continue to cook, stirring occasionally, for 1 minute. Add the chicken stock and cook, tossing occasionally, until the green beans are crisp-tender, about 4 minutes. Using tongs, lift the green beans from the pan and transfer to the baking dish; set aside.
Add the heavy cream and rosemary to the sauté pan and bring to a simmer. Continue simmering until slightly reduced, about 2 minutes. Add the butter and stir until melted, then pour the mixture over the green beans. DO AHEAD: The green beans can be prepared up to this point, covered, and kept at room temperature for 1 hour.
Sprinkle the almonds and Cheddar over the green beans and bake until the cheese is melted and the green beans are hot, about 10 minutes.
