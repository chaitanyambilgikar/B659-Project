Preheat oven to 375°F with rack in middle. Butter baking dish
For the topping: Pulse together flour, sugar, butter, salt, and extracts in a food processor until some large clumps form.
Set aside 1/4 cup for filling and transfer remaining topping to a bowl. Stir in almonds.
For the filling: Cook sugar in a dry 2-quart heavy saucepan over moderate heat, undisturbed, until it begins to melt. Continue to cook, stirring occasionally with a wooden spoon, until sugar is melted into a deep-golden caramel.
Remove from heat and carefully add apple juice, butter, and salt (caramel will harden and steam vigorously). Cook over moderately low heat, stirring, until caramel is dissolved.
Put apples in a large bowl and toss with reserved topping mixture and caramel, then spread in baking dish. (Dish will be very full.)
Scatter clumps of topping over apples, squeezing small handfuls of topping into clumps when necessary.
Bake until apples are tender and top is golden and crisp, about 1 hour. Cool to warm or room temperature.
