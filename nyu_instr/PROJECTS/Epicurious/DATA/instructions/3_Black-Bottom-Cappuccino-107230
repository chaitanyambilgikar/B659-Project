Make caramel pudding: Bring sugar and water to a boil in a 3-quart heavy saucepan over moderately high heat, stirring until sugar is dissolved. Boil, without stirring but washing down any sugar crystals on side of pan with a pastry brush dipped in cold water, until syrup begins to turn golden, about 5 minutes. Reduce heat to moderate and continue to boil, swirling pan occasionally, until syrup is a dark mahogany color (it's important to make caramel as dark as possible without burning to give sufficient flavor to pudding).
Remove pan from heat and immediately add cream (caramel will bubble up and steam), stirring until combined. If not all caramel is dissolved, cook over moderate heat, stirring, about 1 minute more.
Stir 2 1/2 cups milk into caramel and bring to a simmer. Whisk together remaining 1/2 cup milk and cornstarch in a glass measuring cup, then pour into simmering caramel mixture, whisking. Simmer gently, whisking occasionally, 2 minutes.
Whisk together eggs, vanilla, and a pinch of salt in a large metal bowl. Slowly add 1 cup hot caramel, whisking until combined well, then whisk in remaining caramel.
Reserve 1/2 cup hot pudding, then set bowl with remaining pudding in a larger bowl of ice and cold water, whisking occasionally, to cool.
Make chocolate pudding layer while caramel pudding cools: Melt chocolate in a double boiler or a metal bowl set over a pan of barely simmering water, stirring occasionally, until smooth. Stir in reserved 1/2 cup hot caramel pudding and liqueur, then divide mixture among parfait glasses.
Divide cooled caramel pudding among glasses and chill, loosely covered, at least 2 hours.
Make topping: Beat cream with sugar using an electric mixer until it just holds stiff peaks, then spoon onto chilled puddings, spreading to cover tops.
