Put oven rack in middle position and preheat oven to 350°F. Grease a 9-inch square baking pan (2 inches deep) and line bottom and sides with wax paper, then butter paper.
Melt butter and chocolate in a medium heatproof bowl set over a saucepan of simmering water, stirring occasionally, until smooth.
Whisk together flour, baking powder, and salt in a small bowl.
Whisk together sugar, eggs, and vanilla in a large bowl, then pour in chocolate mixture, whisking until combined well. Whisk in flour mixture, then stir in walnuts and transfer batter to baking pan.
Bake until top is shiny and set and sides have begun to pull away slightly (a wooden pick or skewer will not come out clean), about 35 minutes, for fudgy brownies; or until wooden pick or skewer comes out clean, 50 minutes to 1 hour total, for cakey brownies.
Cool brownies completely in pan on a rack. Invert onto a cutting board, remove paper, and cut into squares.
