1. Combine the lemongrass, soy sauce, chilies, chili flakes, turmeric, sugar and salt in a bowl. Add the tofu cubes and turn to coat them evenly. Marinate for 30 minutes.
2. Heat half of the oil in a 12-inch nonstick skillet over moderately high heat. Add the onion, shallot and garlic and stir until fragrant, about 1 minute. Reduce the heat to low and cook until the onions are soft, about 3 minutes. Transfer to a plate and keep warm.
3. Wipe the pan clean and heat the remaining oil over moderate heat. Add the tofu mixture and, using chopstick or wooden spoons, turn so it cooks evenly, about 4 to 5 minutes. Add the onion mixture and cook, uncovered, for another 2 to 3 minutes. Add half the peanuts and all the pepper leaves.
4. Remove from the heat and transfer to a serving plate. Garnish with the remaining peanuts and serve immediately with steamed rice.
