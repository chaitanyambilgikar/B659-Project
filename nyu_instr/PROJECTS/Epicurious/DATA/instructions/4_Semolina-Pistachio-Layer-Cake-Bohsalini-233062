Mix the melted butter and semolina in a medium bowl, and set aside at room temperature for at least 6 hours or as long as overnight.
Pour the milk into a large pot and bring it to a boil over high heat, stirring occasionally. When the milk rises to the top of the pot, stir in the lemon juice and remove the pot from the heat. Set it aside to cool until the milk separates, 10 to 15 minutes.
Pour the milk through a fine-mesh strainer into a bowl, stirring to release the whey. Discard the whey. Transfer the curds in the strainer to a large bowl. Stir in 2 tablespoons rose water and the orange-blossom water with a wooden spoon. The kashta should look like small-curd cottage cheese. Cover and refrigerate until ready to use. (Kashta will keep, covered and refrigerated, for up to 3 days.)
Combine the sugar, pistachios, and remaining 1 tablespoon rose water in a food processor and pulse until the mixture has the consistency of coarse sand. Add the pistachio mixture to the flour mixture, and using your hands, mix them together, breaking up the lumps until the mixture feels like damp sand.
Line a 9-inch springform cake pan with wax paper, using two pieces crossing at right angles and allowing lengths of paper to hang over the sides of the pan. Spoon half of the semolina mixture into the pan and smooth it out to the edges with the back of the spoon. Follow with all of the kashta, spreading it over the semolina in an even layer. Spoon the remaining semolina mixture on top and spread it out in an even layer. Fold the overhanging wax paper over the top, and press to smooth the semolina. Cover with plastic wrap and refrigerate overnight.
Pour the olive oil into a skillet that is large enough to accommodate the nuts in a single layer. Heat the oil over medium-high heat. Add the nuts, reduce the heat to low, and stir actively until they begin to darken slightly, about 1 minute (see Tips, below). Remove the pan from the heat, and use a slotted spoon to transfer the nuts to a paper towel-lined plate to drain. (Alternatively, dump the nuts into a medium-mesh sieve set over a container to catch the cooking oil.) Let them cool completely. (Fried nuts can be stored in a sealed container in the refrigerator or freezer for up to 3 months.)
One hour before serving, remove the cake from the refrigerator, invert it onto a serving plate, and release it from the pan. Sprinkle the powdered sugar on top: Hold a fine-mesh sieve over the cake, pour the powdered sugar into it, and gently tap the rim to release the sugar. Garnish with the nuts, and serve in wedges.
