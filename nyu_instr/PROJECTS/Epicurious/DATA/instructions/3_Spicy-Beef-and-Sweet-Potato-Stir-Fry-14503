Thinly slice onion and garlic. Peel sweet potatoes and cut lengthwise into 1/8-inch -thick slices. Diagonally cut potato slices into thin strips and diagonally halve snow peas. Cut water chestnuts crosswise into 1/8-inch-thick slices and season with salt and pepper. Diagonally cut scallions into thin slices. In a small bowl stir together broth, hoisin sauce, brandy, and cornstarch until combined well.
Heat a wok or large heavy skillet over high heat until a bead of water dropped on cooking surface evaporates immediately. Add 2 tablespoons peanut oil, swirling wok or skillet to coat evenly, and heat until hot but not smoking. Add onion and stir-fry until softened. Add garlic and stir-fry until fragrant, about 30 seconds. Add sweet potatoes and stir-fry until just tender, 6 to 8 minutes. Add snow peas and water chestnuts and stir-fry until snow peas are crisp-tender, about 2 minutes. Transfer vegetables to a large bowl.
Add 1 tablespoon peanut oil to wok or skillet and heat unrig just smoking. Stir-fry half of beef until browned and transfer to bowl. Add remaining tablespoon peanut oil and stir-fry remaining beef in same manner, transferring to bowl.
Add broth mixture to wok or skillet and bring to a boil, stirring constantly. Simmer broth mixture 1 minute. Return beef-vegetable mixture with scallions to wok or skillet and stir-fry until combined and heated through. Season stir-fry with salt and pepper and stir in sesame oil.
Serve stir-fry over rice, garnished with scallions.
