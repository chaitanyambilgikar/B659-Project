In a food processor coarsely pureé beans and tomatoes.In a 6-quart heavy kettle cook onion, shallot, garlic, cumin, salt, and pepper in butter over moderate heat, stirring, until onion is softened and beginning to brown. Stir in bean pureé. Stir in broth, pumpkin, and Sherry until combined and simmer, uncovered, stirring occasionally, 25 minutes, or until thick enough to coat the back of a spoon.
Just before serving, add ham and vinegar and simmer soup, stirring, until heated through. Season soup with salt and pepper.
Serve soup garnished with sour cream and toasted pumpkin seeds.
