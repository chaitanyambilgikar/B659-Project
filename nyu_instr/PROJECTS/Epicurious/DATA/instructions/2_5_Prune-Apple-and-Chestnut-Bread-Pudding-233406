For bread mixture: Preheat oven to 350°F. Place bread on large rimmed baking sheet. Bake until almost firm, about 7 minutes. Cool on sheet. Whisk remaining ingredients in large bowl to blend. Stir in bread. Cover and chill until bread absorbs custard, at least 3 hours.
For filling: Preheat oven to 400°F. Sauté bacon in large ovenproof skillet over medium-high heat until fat renders, about 7 minutes. Drain all but 2 tablespoons fat into small bowl. Add onions to bacon and fat in skillet and sauté until soft, about 10 minutes.
Add apples, chestnuts, celery root, and thyme. Sprinkle with salt and pepper. Sauté 5 minutes to blend flavors. Add Sherry. Boil until juices thicken to syrup consistency, about 2 minutes. Add broth and bring to boil. Place skillet in oven and bake uncovered until apples and celery root are tender, about 20 minutes. Mix in whole prunes and 2 tablespoons of reserved bacon fat. Season to taste with salt and pepper. (Bread mixture and filling can be prepared 1 day ahead. Keep bread mixture refrigerated. Cover filling and refrigerate.)
Preheat oven to 325°F. Spread filling in 3 1/2-quart ovenproof casserole or 13x9x2-inch glass baking dish. Spoon bread mixture evenly over, covering completely. Bake pudding until puffed, golden brown, and firm to touch in center, about 45 minutes. Let stand 10 minutes before serving.
